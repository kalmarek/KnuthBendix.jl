<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Confluence and the Knuth-Bendix completion · KnuthBendix.jl</title><meta name="title" content="Confluence and the Knuth-Bendix completion · KnuthBendix.jl"/><meta property="og:title" content="Confluence and the Knuth-Bendix completion · KnuthBendix.jl"/><meta property="twitter:title" content="Confluence and the Knuth-Bendix completion · KnuthBendix.jl"/><meta name="description" content="Documentation for KnuthBendix.jl."/><meta property="og:description" content="Documentation for KnuthBendix.jl."/><meta property="twitter:description" content="Documentation for KnuthBendix.jl."/><meta property="og:url" content="https://kalmarek.github.io/KnuthBendix.jl/knuthbendix_completion/"/><meta property="twitter:url" content="https://kalmarek.github.io/KnuthBendix.jl/knuthbendix_completion/"/><link rel="canonical" href="https://kalmarek.github.io/KnuthBendix.jl/knuthbendix_completion/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">KnuthBendix.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory/">Monoids and the word problem</a></li><li class="is-active"><a class="tocitem" href>Confluence and the Knuth-Bendix completion</a><ul class="internal"><li><a class="tocitem" href="#Local-confluence-and-suffix-prefix-words"><span>Local confluence and suffix-prefix words</span></a></li><li><a class="tocitem" href="#Knuth-Bendix-completion-an-example"><span>Knuth Bendix completion - an example</span></a></li></ul></li></ul></li><li><span class="tocitem">Words and Alphabets</span><ul><li><a class="tocitem" href="../words/">Words</a></li><li><a class="tocitem" href="../alphabets/">Alphabets</a></li><li><a class="tocitem" href="../orders/">Orders</a></li></ul></li><li><span class="tocitem">Rewriting</span><ul><li><a class="tocitem" href="../rewriting/">On rewriting</a></li><li><a class="tocitem" href="../rewriting_system/">Rewriting System</a></li></ul></li><li><span class="tocitem">Knuth-Bendix completion</span><ul><li><a class="tocitem" href="../KB_implementations/">Implementations of Knuth-Bendix completion</a></li><li><a class="tocitem" href="../knuthbendix1/">Naive</a></li><li><a class="tocitem" href="../knuthbendix2/">Using a stack</a></li><li><a class="tocitem" href="../knuthbendix_idxA/">Using index automaton</a></li></ul></li><li><a class="tocitem" href="../parsing_kbmag/">Parsing <code>kbmag</code> input files</a></li><li><span class="tocitem">Applications</span><ul><li><a class="tocitem" href="../nc_groebner/">Non-commutative Gröbner bases</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Confluence and the Knuth-Bendix completion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Confluence and the Knuth-Bendix completion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kalmarek/KnuthBendix.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kalmarek/KnuthBendix.jl/blob/master/docs/src/knuthbendix_completion.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Confluence-and-the-Knuth-Bendix-completion"><a class="docs-heading-anchor" href="#Confluence-and-the-Knuth-Bendix-completion">Confluence and the Knuth-Bendix completion</a><a id="Confluence-and-the-Knuth-Bendix-completion-1"></a><a class="docs-heading-anchor-permalink" href="#Confluence-and-the-Knuth-Bendix-completion" title="Permalink"></a></h1><p>Confluence is a notion that describes in a formal way the independence of the result of the rewriting procedure (w.r.t. <span>$\mathcal{R}$</span>) on particular choices made in the process (without specifying any algorithm!). In colloquial form it goes like this: whenever the rewrite paths of any word <span>$w$</span> diverge, there is a common point later where they agree again. In more formal way</p><div class="admonition is-info"><header class="admonition-header">Confluence</header><div class="admonition-body"><p>We say that a rewriting system <span>$\mathcal{R}$</span> is <strong>confulent</strong> if for every word <span>$w \in \mathcal{A}^*$</span> and two rewrites <span>$p_1, p_2 \in \mathcal{A}^*$</span> of <span>$w$</span> there exist a common rewrite <span>$q \in \mathcal{A}^*$</span> for both of them.</p></div></div><p>Let us denote by <span>$w \xrightarrow{}_{\mathcal{R}} p$</span> that <span>$p$</span> is the result of applying a <strong>single</strong> rewriting rule from <span>$\mathcal{R}$</span> <strong>once</strong> to <span>$w$</span>, and by <span>$w \xrightarrow{*}_{\mathcal{R}} p$</span> that <span>$p$</span> is the result of rewriting of <span>$w$</span> with any number of rules from <span>$\mathcal{R}$</span>. Confluence can be succintly phrased as</p><p class="math-container">\[\forall{w} \left(\;
(p_1 {\,}_{\mathcal{R}}{\xleftarrow{*}}\; w \xrightarrow{*}_{\mathcal{R}} p_2)
\implies \exists q \;
p_1 \xrightarrow{*}_{\mathcal{R}} q {\,}_{\mathcal{R}}{\xleftarrow{*}}\; p_2\right).\]</p><h2 id="Local-confluence-and-suffix-prefix-words"><a class="docs-heading-anchor" href="#Local-confluence-and-suffix-prefix-words">Local confluence and suffix-prefix words</a><a id="Local-confluence-and-suffix-prefix-words-1"></a><a class="docs-heading-anchor-permalink" href="#Local-confluence-and-suffix-prefix-words" title="Permalink"></a></h2><p>It turns out that confluence is equivalent to <strong>local confluence</strong>. What does <em>local</em> mean? That we allow only a single rewrite by a rule of <span>$\mathcal{R}$</span> to arrive at <span>$p_1$</span> or <span>$p_2$</span> (<span>$q$</span> can be still arrived at by arbitrary number of rewrties):</p><p class="math-container">\[\forall{w} \left(\;
(p_1 {\,}_{\mathcal{R}}{\xleftarrow{}}\; w \xrightarrow{}_{\mathcal{R}} p_2)
\implies \exists q \;
p_1 \xrightarrow{*}_{\mathcal{R}} q {\,}_{\mathcal{R}}{\xleftarrow{*}}\; p_2\right).\]</p><p>Local confluence seems a much weaker condition than normal confluence and yet they are equivalent and the former is <strong>much easier</strong> to check! While the set of words for which local confluence fails may be infinite, the shortest among them, i.e. the ones where local confluence holds for all proper subwords, can be characterized in terms of <span>$\mathcal{R}$</span> explicitly! They are formed from pairs of rules where a suffix of the left-hand-side of one rule is a prefix of the left-hand-side of the other. Suppose we have two rules <span>$p_i \to q_i$</span> (<span>$i = 1,2$</span>) and that <span>$p_1 = a\cdot b$</span> and <span>$p_2 = b\cdot c$</span> (<span>$b \neq \varepsilon$</span>), we can rewrite <span>$w = a\cdot b \cdot c$</span></p><p class="math-container">\[q_1 \cdot c {\,}_{\mathcal{R}}{\xleftarrow{}}\;
p_1 \cdot c = w = a\cdot p_2
\xrightarrow{}_{\mathcal{R}} A\cdot q_2\]</p><p>in two (potentially) different ways. If we can show that none of the candidates fails local confluence the rewriting system <span>$\mathcal{R}$</span> is confluent and hence can be used to solve the word problem!</p><p>Note, however, that as we check a pair of rules for failure to local confluence, new rewriting rules are often discovered and added to <span>$\mathcal{R}$</span> hence new additional pairs of rules need to be checked and the whole process becomes potentially infinite.</p><h2 id="Knuth-Bendix-completion-an-example"><a class="docs-heading-anchor" href="#Knuth-Bendix-completion-an-example">Knuth Bendix completion - an example</a><a id="Knuth-Bendix-completion-an-example-1"></a><a class="docs-heading-anchor-permalink" href="#Knuth-Bendix-completion-an-example" title="Permalink"></a></h2><p>Let us work out an example. We begin with alphabet <span>$\mathcal{A} = \{a, A, b\}$</span> ordered by the length-then-lexicographical order on <span>$\mathcal{A}^*$</span> defined by <span>$a &lt; A &lt; b$</span>.</p><p>Here are our generating pairs for the congruence:</p><blockquote><p class="math-container">\[R = \{(aA, \varepsilon), (Aa, \varepsilon), (bbb, \varepsilon), (ab, ba)\}.\]</p></blockquote><p>We note that in the last pair we have <span>$ab &lt; ba$</span>, so we will need to reverse the pair while the initial rewriting system <span>$\mathcal{R}$</span>. It consists of the following rules:</p><ol><li><p><span>$aA \to \varepsilon$</span>,</p></li><li><p><span>$Aa \to \varepsilon$</span>,</p></li><li><p><span>$bbb \to \varepsilon$</span>,</p></li><li><p><span>$ba \to ab$</span>.</p><p>Is this system confluent? As one indication of non-confluence we could observe that while <span>$b$</span> commutes with <span>$a$</span>, we have no idea so far if <span>$b$</span> commutes with <span>$A$</span>. Well we know that it should, since <span>$A$</span> smells like an &quot;inverse&quot; of <span>$a$</span> but the rewriting system doesn&#39;t know this yet! Let us proceed through the Knuth-Bendix procedure of discovering new rules through suffix-prefix &#39;intersections&#39; of rules left-hand-sides.</p><ul><li>Analyzing pair (1,1) gives no suffix-prefix word, hence no candidates for failure of local confluence.</li><li>Analyzing rule (1,2) we see that with suffix-prefix equal to <span>$A$</span> we can rewrite <span>$a\cdot A\cdot a$</span> by either rule 1 or rule 2 (we used <span>$\cdot$</span> to separate the suffix-prefix word). Both rewrites result in <span>$\varepsilon \cdot a = a = a \cdot\varepsilon$</span>, so the local confluence holds here (and similarly for (2,1)).</li><li>Pair (2,2) gives no candidates and so do pairs (3,1) and (3,2).</li><li>Pair (3,3) results in candidates <span>$bb\cdot b \cdot bb$</span> and <span>$b\cdot bb\cdot b$</span>. Both of rewrites of these words lead to the same result (either <span>$bb$</span>, or <span>$b$</span>), so local confluence still holds here.</li><li>No further candidates are uncoverd considering pairs (3, 1) and (3, 2).</li><li>Finally moving to rule 4 we see something interesting:<ul><li>pairs (1,4) and (2,4) give no candidates;</li><li>pair (3,4) results in word <span>$bb\cdot b\cdot a$</span> which can be rewritten in two essentially different ways: <span>$p_1 = \varepsilon \cdot a = a$</span>, or <span>$p_2 = bb\cdot ab$</span>. However applying rule 4 two more times rewrites the latter to <span>$p_2&#39; = a\cdot bbb$</span> and after the final rewrite with rule 3 we obtain <span>$q = a\cdot \varepsilon = a$</span>. Thus <span>$p_2 \xrightarrow{*}_\mathcal{R} q = p_1$</span> and local confluence holds here  as well.</li><li>pair (4,4) gives no candidates</li><li>pair (4,1) results in word <span>$b\cdot a\cdot A$</span> with two essentially different rewrites: <span>$p_1 = ab\cdot A$</span> and <span>$p_2 = b \cdot \varepsilon = b$</span>. None of <span>$p_1$</span> and <span>$p_2$</span> can be rewritten any further, so we found the first failure to the local confluence and in the process we discovered a new rewriting rule which we add to <span>$\mathcal{R}$</span> (after the appropriate reordering) as</li></ul></li></ul></li><li><p><span>$abA \to b$</span>.</p><p>Further pairs (4,2) and (4,3) give no candidates for local confluence. However, we are not finished yet, since we&#39;ve added rule 5 and we have 9 more pairs of rules to check. For brevity let&#39;s discuss onlt those pairs which give candidates:</p><ul><li>(5,2): the candidate word <span>$ab \cdot A \cdot a$</span> rewrites as either <span>$ab$</span> or <span>$aAba$</span>; applying rules 1 and 4 to the latter we arrive at <span>$ab$</span> and no failure to local confluence is discovered.</li><li>(2,5): the candidate word <span>$A\cdot a\cdot bA$</span> rewrites as <span>$bA$</span> (rule 2) or as <span>$Ab$</span> (rule 5), which leads to new rule</li></ul></li><li><p><span>$bA \to Ab$</span></p><ul><li>(4,5): the candidate word <span>$b\cdot a \cdot bA$</span> rewrites as <span>$bb$</span> (rule 5) or as <span>$abbA$</span> (rule 4) which rewrites further to <span>$bb$</span> (twice applying newly discovered rule 6 then rule 1). Local confluence holds for this pair.</li></ul><p>At this point we have finished processing rule 5, but now we have 11 more pairs to check with our newly added rule 6. Processing those we arrive at three candidates (from pairs (3,6), (5,6), and (6,2)). None of these fails local confluence, hence we stop and report the rewriting system with rules 1-6 as confluent.</p></li></ol><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Note that had we chosen a different order of processing the pairs we could have ended with an infinite sequence of rules of the form <span>$a^n b A^n \to b$</span> and the process might have never stopped. This order in particular is dependent on the ordering of <span>$\mathcal{A}^*$</span> as we have essentially reduced the word problem to the problem of finding an order on which Knuth-Bendix completion terminates.</p></div></div><p>One may observe that once we discver rule 6, rule 5 becomes redundant: we can apply rule 6 to the left-hand-side of rule 5 which leads to <span>$abA \xrightarrow{} aAb \xrightarrow{} b$</span>, i.e. rule 5 is a consequence of rules 1 and 6, and as such can be removed. The minimal set of rules forms the (unique!) <strong>reduced confluent rewriting system</strong> <span>$\mathcal{RC}(R, &lt;)$</span>, which in this case consists of</p><blockquote><ol><li><span>$aA \to \varepsilon$</span>,</li><li><span>$Aa \to \varepsilon$</span>,</li><li><span>$bbb \to \varepsilon$</span>,</li><li><span>$ba \to ab$</span>,</li><li><span>$bA \to Ab$</span>.</li></ol></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Monoids and the word problem</a><a class="docs-footer-nextpage" href="../words/">Words »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Monday 2 October 2023 14:40">Monday 2 October 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
